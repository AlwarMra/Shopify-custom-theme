DT.last_products={t:{anadelo_por:window.anadelo},n_prod:window.ultimas_n||16,current_index:0,init:function(a){console.log("[LAST PRODUCTS]=\n",a),a.this_product&&window.paramsUltimas&&(console.log("SSSSSSSSSSSSSSSS"),this.save(a.this_product)),this.show_last_products()&&(this.applay_behaviors(),a=$(".card_0").attr("data-link")+".json",this.update_price(a))},applay_behaviors:function(){return console.log("[LAST PRODUCTS] -> applay_behaviors"),$(document).on("click",".product_card_",function(a){a.preventDefault(),DT.last_products.mover()}),$("#btn_cards_next").click(function(a){a.preventDefault(),console.log("[LAST PRODUCTS]=\n","btn_cards_next"),DT.last_products.mover()}),$("#btn_cards_prev").click(function(a){a.preventDefault(),console.log("[LAST PRODUCTS]=\n","btn_cards_prev"),DT.last_products.mover_reverse()}),!0},mover_reverse:function(){console.log("[LAST PRODUCTS]=\n","----mover_reverse----");var t=this,a=$(".card_0"),r=$(".card_1");$(".card_2").remove(),this.current_index--,this.current_index<0&&(this.current_index=this.list_last.length-1);var s=this.current_index;console.log("[LAST PRODUCTS]","\n this.current_index ",this.current_index,"\n new_card_index",s);s=this.format_product(this.list_last[s],s,0,"card_0_temp");$("#dv_last_prods").prepend(s),$(".card_0_temp").addClass("a_la_derecha_reverse"),a.addClass("card_transform_to_1_reverse").removeClass("card_0").addClass("card_1"),r.addClass("card_transform_to_2_reverse").removeClass("card_1").addClass("card_2"),setTimeout(function(){$(".card_0_temp").removeClass("a_la_derecha_reverse").removeClass("card_0_temp").addClass("card_0").data("index","0");var a=$(".card_0").attr("data-link")+".json";t.update_price(a)},300),setTimeout(function(){a.removeClass("card_transform_to_1_reverse"),r.removeClass("card_transform_to_2_reverse")},500)},mover:function(){console.log("[LAST PRODUCTS]=\n","mover");var t=this,a=$(".card_0"),r=$(".card_1"),s=$(".card_2");e=this.current_index==this.list_last.length-3?0:this.current_index==this.list_last.length-2?1:this.current_index==this.list_last.length-1?2:this.current_index+3,this.current_index++,this.current_index==this.list_last.length&&(this.current_index=0),console.log("[LAST PRODUCTS]","\n this.current_index ",this.current_index,"\n new_card_index",e);var e=this.format_product(this.list_last[e],e,2,"card_2_temp");$("#dv_last_prods").append(e),a.addClass("a_la_derecha"),r.addClass("card_transform_to_0"),setTimeout(function(){r.removeClass("card_1").addClass("card_0"),s.addClass("card_transform_to_1").removeClass("card_2").addClass("card_1"),$(".card_2_temp").removeClass("card_2_temp"),a.remove()},300),setTimeout(function(){r.removeClass("card_transform_to_0"),s.removeClass("card_transform_to_1");var a=$(".card_0").attr("data-link")+".json";t.update_price(a)},500)},save:function(a){console.log("last_products save",a.id),this.arr_nav=JSON.parse(this.get())||[],_.find(this.arr_nav,{id:a.id})||(this.arr_nav.reverse(),this.arr_nav.push(a),this.arr_nav.reverse(),this.arr_nav=this.arr_nav.slice(0,this.n_prod),window.localStorage.setItem("DTLastProducts",JSON.stringify(this.arr_nav)))},get:function(){return window.localStorage.getItem("DTLastProducts")||!1},format_product:function(t,a,r,s=!1){console.log("[format_product]",r,a+")"+t.title.split("|")[0]);var e="card_"+r+" ";s&&(e+=" "+s);var i='<span class="marca">DIOR</span>',n="dia",o="Hombre",c=t.featured_image;_.each(t.tags,function(a){"estacion"==(a=a.trim().split(":"))[0]&&a[1],"marca"==a[0]&&(i='<span class="marca">'+a[1]+"</span>"),"uso"==a[0]&&(n=a[1]),"familia"==a[0]&&a[1],"envase"==a[0]&&a[1],"n_opiniones"==a[0]&&a[1],"categoria"==a[0]&&"nicho"!=a[1]&&(o=a[1])});var d=n.capitalize();"mujer"!=o&&"dia"==n?d="back-dia-gen":"mujer"!=o&&"noche"==n&&(d="back-noche-gen"),"hombre"==o&&"dia"==n?d="back-dia-hombre":"hombre"==o&&"noche"==n&&(d="back-noche-hombre"),n=DT.str[n].capitalize(),o=DT.str[o],"Rise.ai"==t.vendor&&(i="",o=n=" ");r=window.ultimas_shop+"/products/"+t.handle,s="";null!=t.variants[0].compare_at_price&&(s=t.variants[0].compare_at_price),console.log("SDFDSFSDFDSFSDF",t.variants[0]);var l,p,u,h,v,m,f,g,S,b="false";for(let a=0;t.variants.length>a;a++)if(0==t.variants[a].price&&t.variants[a].available){b=t.variants[a].id;break}return'<div class="last-search-card product_card '+e+'" data-link="'+r+'" data-index="'+a+'"><div class="last-img-back '+d+'">'+i+'    <span class="section-title day">'+n+'</span> </div> <div class="last-card-content">    <a href="'+r+'" class="img-card" style="background: url('+c+'); background-repeat: no-repeat; background-size: cover; background-position:center;"></a>    <div class="last-card-text">'+(l=t.title,p=r,f=l.split("|"),g=f[0],S=DT.str["Similar a"],l=DT.str.de,f[1]?(h=f[1].replace(S,"").split(l)[1],u=f[1].replace(S,"").split(l)[0],f[2]):u="",h=h||"Divain","Rise.ai"==t.vendor&&(u=f[0],h=l="",v='style="display: none;"',m=" lastgift "),'<a href="'+p+'" class="lastsearch-name-title" style="width:100%; text-decoration: none; position: relative;"><p><span '+v+' class="lastsearch-title-top">'+g+" - "+S+'</span><br>   <a style="text-decoration:none;" href="'+p+'" class="lastsearch-product-name '+m+'">  '+u+" "+l+" "+h+"</a></p> </a>")+'<div class="vendor-and-button"><p class="product-categoria"> '+o+' </p></div><a id="add_to_cart-'+t.id+'-ult" class="button button-add button-and-busqueda" href="#" data-compared="'+s+'" data-rel="'+t.variants[0].id+'" data-free="'+b+'">'+this.t.anadelo_por+'<span class="price"></span></a>  </div> </div> </div>'},show_last_products:function(){if(this.list_last=JSON.parse(this.get())||[],console.log("[show_last_products]",this.n_prod,this.list_last.length),0!=this.list_last.length){var r="";return _this=this,_.each(this.list_last,function(a,t){console.log(t+")"+a.title.split("|")[0])}),_.each(this.list_last,function(a,t){t<=2&&(r+=_this.format_product(a,t,t))}),$("#dv_last_prods").html(r),!0}$("#ultimas-busquedas").remove()},update_price:function(a){$.ajax({url:a,type:"GET"}).done(function(a){var t=a.product.variants[0].price,a=a.product.variants[0].compare_at_price.replace(".","");$(".card_0 .price").html(" "+t+" â‚¬"),$(".card_0 .button-and-busqueda").data("compared",a)}).fail(function(a){console.log("fail to retrieve product json")})}},DT.last_products.init({this_product:window.ultimas_this_product});