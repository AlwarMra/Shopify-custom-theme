console.log("::::::WISHLIST:::::"),DT.wishlist={data:JSON.parse(window.localStorage.getItem("GL_WISHLIST"))||{customer:!1,products:[]},init:function(){const o=this;0<this.data.products.length&&$(".wish-link").addClass("active"),console.log("Wishlist products",this.data.products),window.customer&&!this.data.customer&&(this.data.customer=window.customer,window.localStorage.setItem("GL_WISHLIST",JSON.stringify(this.data))),this.is_wishlist_page(),$(".love-container").on("click",function(t){t.preventDefault();t=$(this).data("handle");$(this).hasClass("active-wish")?($(this).removeClass("active-wish"),o.remove(t),$("#product-wishlist").length&&o.inner_text($(this).find(".love-text").get(0),!1)):($(this).addClass("active-wish"),o.get_product(t,t=>o.save(t)),$("#product-wishlist").length&&o.inner_text($(this).find(".love-text").get(0)))}),$("#copy").on("click",function(){var t=$('<input id="url-hidden">');$("body").append(t),t.val($("#paramsUrl").val()).select(),document.execCommand("copy"),t.remove(),$(this).addClass("copied"),setTimeout(()=>{$(this).removeClass("copied")},2e3)}),$("#add_all").on("click",function(){$(this).addClass("button-deactivate");var e=[];if(window.location.search){var i=0;$(".love-container").each(function(){var t={_compare_at_price:$(this).data("compared")},a={id:$(this).data("id"),properties:t};"false"==$(this).data("free")&&null==$(this).data("free")||(t={id:$(this).data("free"),properties:{_compare_at_price:0,_id_associated:$(this).data("id")}},e.push(t)),e.push(a),++i==$(".love-container").length&&o.add_all(e)})}else{var a=o.data.products;for(let t=0;a.length>t;t++){var s={_compare_at_price:a[t].compare_at_price},r={id:a[t].id,properties:s};"false"==a[t].free&&null==$(this).data("free")||(s={id:a[t].free,properties:{_compare_at_price:0,_id_associated:a[t].id}},e.push(s)),e.push(r)}o.add_all(e)}})},is_wishlist_page:function(){var a=[];if($("#wishlist-page").length)if(window.location.search){var t=window.location.search,a=(t=new URLSearchParams(t)).get("ids").split("|");document.getElementById("paramsUrl").value=window.location.href,this.share_button(window.location.href),this.get_product_from_url(a)}else{for(let t=0;this.data.products.length>t;t++){var e=this.data.products[t];e.handle?a.push(e.handle):a.push(e.product_handle)}t=window.location.href+"/?ids="+a.join("|");document.getElementById("paramsUrl").value=t,this.share_button(t),this.format_products(this.data.products)}else this.is_in_wishlist()},save:function(a){this.data.products.find(t=>t.product_id===a.product_id)||this.data.products.push(a),window.localStorage.setItem("GL_WISHLIST",JSON.stringify(this.data))},remove:function(a){this.data.products=this.data.products.filter(t=>t.product_handle!==a),window.localStorage.setItem("GL_WISHLIST",JSON.stringify(this.data))},get_product:function(t,i){$.ajax({type:"GET",url:"/products/"+t+".js",dataType:"JSON",success:function(a){console.log(a);var t=!1;a.variants[0].available&&(t=!0);var e="false";for(let t=0;a.variants.length>t;t++)if(0==a.variants[t].price&&a.variants[t].available){e=a.variants[t].id;break}a={product_handle:a.handle,product_id:a.variants[0].id,product_id_params:a.id,product_url:a.url,product_title:a.title,product_image:a.featured_image,product_image_2:a.images[2],product_available:t,free:e,price:a.variants[0].price,price_format:a.variants[0].price,compare_at_price:a.variants[0].compare_at_price,compare_price_format:a.variants[0].compare_at_price,tags:a.tags,type:a.type,time:Date.now()/1e3},i&&i(a)}})},is_in_wishlist:function(){var e=this.data.products.map(function(t){return t.product_handle});const i=$(".love-container");for(let a=0;a<i.length;a++)for(let t=0;t<e.length;t++)i[a].dataset.handle===e[t]&&i[a].classList.add("active-wish")},inner_text:function(t,a=!0){t.innerText=a?DT.str.wishlist_in:DT.str.wishlist_out},format_products:function(t){var r=_.template($("#wishlist_template").html());const o=DT.money_format;t.forEach(function(a){a.similar=DT.str["Similar a"],a.of=DT.str.de;var t=a.product_title.split("|");a.title=t[0],a.name=t[1].replace(a.similar,"").split(a.of)[0],a.handle=a.product_handle,a.id=a.product_id,a.url=a.product_url,a.image=a.product_image,a.image_2=a.product_image_2,a.categoria="HOMBRE",a.marca="Divain";var e="",i="",s="";a.tags=a.tags,a.tags.forEach(function(t){"categoria"==(t=t.includes(":")?t.trim().split(":"):t)[0]&&(a.categoria=t[1].toUpperCase()),"marca"==t[0]&&(a.marca=t[1]),"oferta"==t[0]&&(e='<span class="tagoffer">'+t[1]+"</span>"),"oferta2"==t[0]&&(i='<span class="tagoffer2">'+t[1]+"</span>"),"novedad"==t[0]&&(i='<span class="novedad">New</span>'),"musthave"==t[0]&&(i='<span class="musthave">Must Have</span>'),"special"==t[0]&&(s=`<span class="special">${DT.str.special}</span>`)}),categoria_tag=`<span class="category">${a.categoria}</span>`,a.oferta=""!=e||""!=i||""!=s?`<p class="card-offer">${categoria_tag} ${e} ${i} ${e}</p>`:""!=e||""!=i?`<p class="card-offer">${categoria1_tag} ${i} ${e}</p>`:"",a.available=a.product_available,a.free=a.free,a.compare_at_price=a.compare_at_price,a.price=a.price,a.price_format=Shopify.formatMoney(a.price,o),null!=a.compare_at_price&&(a.compare_price_format=Shopify.formatMoney(a.compare_at_price,o));t=r(a);$(".best-sellers-cards").append(t)}),$(".add-all-container").show(),this.is_in_wishlist()},get_product_from_url:function(t){var i=this,s=[],r=0;t.forEach(function(t,a,e){i.get_product(t,function(t){s.push(t),++r===e.length&&i.format_products(s)})})},add_all:function(a){const e=this;var t;$(".loading-wish").show(),0<a.length?(t=a.pop(),$.ajax({type:"POST",url:"/cart/add.js",dataType:"json",data:{id:t.id,q:1,properties:t.properties},success:function(t){e.add_all(a)},error:function(){console.log("error")}})):document.location="/cart"},share_button:function(t){window.innerWidth<=768&&navigator.share?($("#share-mb").show(),$("#share-mb").on("click",()=>{navigator.share({title:DT.str.wishlist_share_title,text:DT.str.wishlist_share_text,url:t}).then(()=>console.log("Successful share")).catch(t=>console.log("Error sharing",t))})):($(".share-button").show(),document.getElementById("share-facebook").href="https://www.facebook.com/sharer.php?u="+t,document.getElementById("share-whatsapp").href="whatsapp://send?text="+t,document.getElementById("share-mail").href="mailto:?subject="+DT.str.wishlist_share_title+"&body="+DT.str.wishlist_share_text+" "+t)}},$(document).ready(function(){DT.wishlist.init()});